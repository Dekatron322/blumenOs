<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KAD-ELEC Invoice - A4 Format</title>
    <style>
        @page {
            size: A4;
            margin: 15mm;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: white;
            color: black;
            width: 210mm;
            min-height: 297mm;
            padding: 15mm;
            print-color-adjust: exact;
            -webkit-print-color-adjust: exact;
        }

        .invoice-container {
            width: 100%;
            max-width: 180mm;
            margin: 0 auto;
            background: white;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #004B23;
        }

        .logo-section {
            text-align: center;
            width: 60mm;
        }

        .logo {
            height: 25mm;
            margin-bottom: 5px;
        }

        .barcode-section {
            text-align: center;
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .barcode {
            height: 15mm;
            width: 80mm;
            border: 1px solid #ddd;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            color: black;
        }

        .account-section {
            text-align: center;
            width: 60mm;
        }

        .company-name {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }

        .account-number {
            background: #6EAD2A;
            color: white;
            padding: 5px 10px;
            font-weight: bold;
            font-size: 12px;
            border-radius: 3px;
        }

        .section-header {
            background: #004B23;
            color: white;
            text-align: center;
            padding: 8px;
            font-weight: bold;
            font-size: 11px;
            margin-bottom: 0;
        }

        .billing-info {
            display: flex;
            border: 1px solid #333;
            margin-bottom: 15px;
            font-size: 9px;
        }

        .billing-info-left {
            width: 60%;
            border-right: 1px solid #333;
        }

        .billing-info-right {
            width: 40%;
        }

        .sub-header {
            background: #6CAD2B;
            color: white;
            padding: 6px 8px;
            font-weight: bold;
            font-size: 9px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .sub-header-right {
            background: #008001;
            color: white;
            padding: 6px 8px;
            font-weight: bold;
            font-size: 9px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .info-content {
            padding: 8px;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 4px;
            font-size: 8px;
        }

        .info-label {
            font-weight: bold;
        }

        .info-value {
            text-align: right;
            font-weight: bold;
        }

        .charges-section {
            margin-bottom: 15px;
        }

        .charges-grid {
            display: flex;
            border: 1px solid #333;
            font-size: 9px;
        }

        .charges-left {
            width: 60%;
            border-right: 1px solid #333;
        }

        .charges-right {
            width: 40%;
        }

        .total-due-section {
            display: flex;
            border: 1px solid #333;
            margin-bottom: 15px;
        }

        .total-due-left {
            width: 60%;
            background: #6CAD2B;
            padding: 8px;
        }

        .total-due-right {
            width: 40%;
            background: #E1E1E1;
        }

        .total-due-amount {
            background: #008001;
            color: white;
            padding: 8px;
            font-weight: bold;
            font-size: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .total-amount {
            font-size: 12px;
            font-weight: bold;
        }

        .payment-notice {
            display: flex;
            margin-bottom: 15px;
        }

        .payment-notice-content {
            width: 60%;
            border: 1px solid #333;
            padding: 8px;
            font-size: 7px;
        }

        .payment-notice-title {
            font-weight: bold;
            margin-bottom: 4px;
            font-size: 7px;
        }

        .payment-notice-text {
            font-weight: bold;
            line-height: 1.3;
        }

        .summary-section {
            display: flex;
            border: 1px solid #333;
            font-size: 8px;
            margin-bottom: 15px;
        }

        .summary-left {
            width: 66.67%;
            border-right: 1px solid #333;
        }

        .summary-right {
            width: 33.33%;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            padding: 8px;
        }

        .final-amount-section {
            display: flex;
            border: 1px solid #333;
            margin-bottom: 15px;
        }

        .final-amount-left {
            width: 66.67%;
            background: #6CAD2B;
            padding: 6px;
        }

        .final-amount-right {
            width: 33.33%;
            background: #E1E1E1;
        }

        .final-amount {
            background: #008001;
            color: white;
            padding: 6px 20px;
            font-weight: bold;
            font-size: 9px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .footer {
            border-top: 1px solid #333;
            padding-top: 8px;
            text-align: center;
            font-size: 7px;
            color: #666;
            margin-top: 10px;
        }

        .footer-line {
            margin-bottom: 2px;
        }

        @media print {
            body {
                margin: 0;
                padding: 15mm;
                width: 210mm;
                height: 297mm;
            }
            
            .invoice-container {
                width: 100%;
                max-width: none;
                margin: 0;
            }
        }
    </style>
</head>
<body>
    <div class="invoice-container">
        <!-- Header -->
        <div class="header">
            <div class="logo-section">
                <img src="/kad.svg" alt="KAD-ELEC Logo" class="logo" />
                <div class="company-name">KAD-ELEC.</div>
            </div>
            
            <div class="barcode-section">
                <div class="barcode" id="barcode">
                    <!-- Barcode will be generated here -->
                </div>
            </div>
            
            <div class="account-section">
                <div class="account-number" id="accountNumber">
                    #1234567890
                </div>
            </div>
        </div>

        <!-- Billing Information -->
        <div class="section-header">BILLING INFORMATION</div>
        <div class="billing-info">
            <div class="billing-info-left">
                <div class="sub-header">
                    <span>AREA OFFICE</span>
                    <span id="areaOffice">MAIN OFFICE</span>
                </div>
                <div class="info-content">
                    <div class="info-row">
                        <span class="info-label">Bill #:</span>
                        <span class="info-value" id="billId">INV-2024-001</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Bill Month:</span>
                        <span class="info-value" id="billMonth">November 2024</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Customer Account:</span>
                        <span class="info-value" id="customerAccount">1234567890</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Account Name:</span>
                        <span class="info-value" id="accountName">John Doe</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Address:</span>
                        <span class="info-value" id="address">123 Main Street, Kaduna</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Phone Number:</span>
                        <span class="info-value" id="phoneNumber">08012345678</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">City:</span>
                        <span class="info-value" id="city">Kaduna</span>
                    </div>
                </div>
            </div>
            
            <div class="billing-info-right">
                <div class="sub-header-right">
                    <span>SERVICE CENTER:</span>
                    <span id="serviceCenter">CENTER 1</span>
                </div>
                <div class="info-content">
                    <div class="info-row">
                        <span class="info-label">State:</span>
                        <span class="info-value" id="state">Kaduna State</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">11KV Feeder:</span>
                        <span class="info-value" id="feeder11kv">FEEDER-A</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">33KV Feeder:</span>
                        <span class="info-value" id="feeder33kv">SUBSTATION-1</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">DT Name:</span>
                        <span class="info-value" id="dtName">DT-001</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Sales Rep:</span>
                        <span class="info-value" id="salesRep">Ahmed Mohammed</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Meter:</span>
                        <span class="info-value" id="meter">MTR123456</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Multiplier:</span>
                        <span class="info-value">1.0</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Billing Charges -->
        <div class="charges-section">
            <div class="section-header">BILLING CHARGES</div>
            <div class="charges-grid">
                <div class="charges-left">
                    <div class="sub-header">
                        <span>CHARGES</span>
                        <span>TOTAL</span>
                    </div>
                    <div class="info-content">
                        <div class="info-row">
                            <span class="info-label">Last Payment Date:</span>
                            <span class="info-value" id="lastPaymentDate">Oct 15, 2024</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Last Payment Amount:</span>
                            <span class="info-value" id="lastPaymentAmount">₦5,000.00</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">ADC:</span>
                            <span class="info-value" id="adc">150</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Present Reading:</span>
                            <span class="info-value" id="presentReading">1,250</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Previous Reading:</span>
                            <span class="info-value" id="previousReading">1,000</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Consumption:</span>
                            <span class="info-value" id="consumption">250kwh</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Tariff Rate:</span>
                            <span class="info-value" id="tariffRate">₦25.50</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Tariff Class:</span>
                            <span class="info-value" id="tariffClass">R2</span>
                        </div>
                    </div>
                </div>
                
                <div class="charges-right">
                    <div class="sub-header-right">
                        <span>CHARGES</span>
                        <span>TOTAL</span>
                    </div>
                    <div class="info-content">
                        <div class="info-row">
                            <span class="info-label">Status Code:</span>
                            <span class="info-value" id="statusCode">Active</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Opening Balance:</span>
                            <span class="info-value" id="openingBalance">₦2,000.00</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Adjustment:</span>
                            <span class="info-value" id="adjustment">₦0.00</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Total Payment Amt:</span>
                            <span class="info-value" id="totalPayment">₦6,375.00</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Net Arrears:</span>
                            <span class="info-value" id="netArrears">₦0.00</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Energy Charged:</span>
                            <span class="info-value" id="energyCharged">₦6,375.00</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Fixed Charge:</span>
                            <span class="info-value" id="fixedCharge">₦500.00</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">VAT:</span>
                            <span class="info-value" id="vat">₦956.25</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Total Due -->
        <div class="total-due-section">
            <div class="total-due-left"></div>
            <div class="total-due-right">
                <div class="total-due-amount">
                    <span>TOTAL DUE:</span>
                    <span class="total-amount" id="totalDue">₦7,331.25</span>
                </div>
            </div>
        </div>

        <!-- Payment Notice -->
        <div class="payment-notice">
            <div class="payment-notice-content">
                <div class="payment-notice-title">IMPORTANT PAYMENT INFORMATION</div>
                <div class="payment-notice-text">
                    PAY ON OR BEFORE DUE DATE 11/15/2025 TO AVOID DISCONNECTION | PAY AT ANY OF OUR OFFICES OR TO OUR SALES REPS USING OUR POSes OR ALTERNATIVE PAYMENT CHANNELS | <b>ALWAYS DEMAND FOR RECEIPT AFTER PAYMENT IS MADE</b>
                </div>
            </div>
            <div style="width: 40%;"></div>
        </div>

        <!-- Summary Section -->
        <div class="summary-section">
            <div class="summary-left">
                <div class="sub-header">
                    <span>Area OFFICE:</span>
                    <span id="summaryAreaOffice">MAIN OFFICE</span>
                </div>
                <div class="summary-grid">
                    <div>
                        <div class="info-row">
                            <span class="info-label">Bill #:</span>
                            <span class="info-value" id="summaryBillId">INV-2024-001</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Bill Month:</span>
                            <span class="info-value" id="summaryBillMonth">November 2024</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Customer Account:</span>
                            <span class="info-value" id="summaryCustomerAccount">1234567890</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Account Name:</span>
                            <span class="info-value" id="summaryAccountName">John Doe</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Address:</span>
                            <span class="info-value" id="summaryAddress">123 Main Street</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Consumption:</span>
                            <span class="info-value" id="summaryConsumption">250kwh</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Opening Balance:</span>
                            <span class="info-value" id="summaryOpeningBalance">₦2,000.00</span>
                        </div>
                    </div>
                    <div>
                        <div class="info-row">
                            <span class="info-label">Adjustment:</span>
                            <span class="info-value" id="summaryAdjustment">₦0.00</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Total Payments:</span>
                            <span class="info-value" id="summaryTotalPayments">₦6,375.00</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Net Arrears:</span>
                            <span class="info-value" id="summaryNetArrears">₦0.00</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Meter:</span>
                            <span class="info-value" id="summaryMeter">MTR123456</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Tariff:</span>
                            <span class="info-value" id="summaryTariff">R2</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Rate:</span>
                            <span class="info-value" id="summaryRate">₦25.50</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">ADC</span>
                            <span class="info-value" id="summaryAdc">150</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="summary-right">
                <div class="sub-header-right">
                    <span>SERVICE CENTER:</span>
                    <span id="summaryServiceCenter">CENTER 1</span>
                </div>
                <div class="info-content">
                    <div class="info-row">
                        <span class="info-label">Present Reading:</span>
                        <span class="info-value" id="summaryPresentReading">1,250</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Previous Reading:</span>
                        <span class="info-value" id="summaryPreviousReading">1,000</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Fixed Charge:</span>
                        <span class="info-value" id="summaryFixedCharge">₦500.00</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Current Bill:</span>
                        <span class="info-value" id="summaryCurrentBill">₦6,375.00</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">VAT:</span>
                        <span class="info-value" id="summaryVat">₦956.25</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Final Amount -->
        <div class="final-amount-section">
            <div class="final-amount-left"></div>
            <div class="final-amount-right">
                <div class="final-amount">
                    <span>FINAL AMOUNT:</span>
                    <span class="total-amount" id="finalAmount">₦7,331.25</span>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <div class="footer-line">
                KADUNA ELECTRICITY DISTRIBUTION COMPANY | Customer Service: 0700 225 5332 | www.kadunaelectric.com
            </div>
            <div class="footer-line">
                This is a computer generated invoice | Invoice Date: <span id="invoiceDate">Nov 1, 2024</span>
            </div>
        </div>
    </div>

    <script>
        // Generate simple barcode
        function generateBarcode() {
            const accountNumber = document.getElementById('accountNumber').textContent.replace('#', '');
            const barcodeElement = document.getElementById('barcode');
            
            // Create a simple barcode pattern
            let hash = 0;
            for (let i = 0; i < accountNumber.length; i++) {
                hash = (hash * 31 + accountNumber.charCodeAt(i)) >>> 0;
            }
            
            const barWidth = 2;
            const totalBars = 40;
            let barcodeHTML = '';
            
            for (let i = 0; i < totalBars; i++) {
                const bit = (hash >> (i % 32)) & 1;
                if (bit === 1) {
                    barcodeHTML += `<span style="display: inline-block; width: ${barWidth}px; height: 30px; background: black; margin: 0 1px;"></span>`;
                } else {
                    barcodeHTML += `<span style="display: inline-block; width: ${barWidth}px; height: 30px; background: white; margin: 0 1px;"></span>`;
                }
            }
            
            barcodeHTML += `<div style="text-align: center; font-size: 10px; margin-top: 2px;">${accountNumber}</div>`;
            barcodeElement.innerHTML = barcodeHTML;
        }

        // Format currency
        function formatCurrency(amount) {
            return new Intl.NumberFormat("en-NG", {
                style: "currency",
                currency: "NGN",
                minimumFractionDigits: 2,
                maximumFractionDigits: 2,
            }).format(amount);
        }

        // Format date
        function formatDate(dateString) {
            return new Date(dateString).toLocaleDateString("en-US", {
                day: "2-digit",
                month: "short",
                year: "numeric",
            });
        }

        // Update invoice with data (you can modify this function to accept real data)
        function updateInvoice(data) {
            // Update all fields with provided data
            if (data.accountNumber) {
                document.getElementById('accountNumber').textContent = '#' + data.accountNumber;
                document.getElementById('customerAccount').textContent = data.accountNumber;
                document.getElementById('summaryCustomerAccount').textContent = data.accountNumber;
            }
            
            if (data.accountName) {
                document.getElementById('accountName').textContent = data.accountName;
                document.getElementById('summaryAccountName').textContent = data.accountName;
            }
            
            if (data.totalDue) {
                const formattedAmount = formatCurrency(data.totalDue);
                document.getElementById('totalDue').textContent = formattedAmount;
                document.getElementById('finalAmount').textContent = formattedAmount;
            }
            
            // Update other fields as needed
            // Add more field updates based on your data structure
            
            // Regenerate barcode with new account number
            generateBarcode();
        }

        // Initialize barcode on page load
        document.addEventListener('DOMContentLoaded', function() {
            generateBarcode();
            
            // Set current date
            const today = new Date();
            document.getElementById('invoiceDate').textContent = formatDate(today.toISOString());
        });

        // Example usage:
        // updateInvoice({
        //     accountNumber: '1234567890',
        //     accountName: 'John Doe',
        //     totalDue: 7331.25
        // });
    </script>
</body>
</html>
